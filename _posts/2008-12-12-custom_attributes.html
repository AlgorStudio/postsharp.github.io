---
layout: post
title: "Custom Attributes"
date: 2008-12-12 09:00:39 +01:00
categories: [General]
permalink: /post/custom-attributes.html
---
<h1>Custom Attributes</h1>
<p>This is the approach of
   <a href="/">
   PostSharp Laos</a>. Aspects are programmed as custom attributes and normally 
   applied to classes, methods and fields. We gave already an example above. 
   Here is a second. It implements transaction boundaries in Visual Basic .NET 
   (the example was simplified for brievety):</p>
<pre>Imports PostSharp.Laos
Imports System.Transactions

 _
Public NotInheritable Class TransactionScopeAttribute
    Inherits OnMethodBoundaryAspect

    Public Overrides Sub OnEntry(
         ByVal eventArgs As PostSharp.Laos.MethodExecutionEventArgs)

        eventArgs.State = New TransactionScope()

    End Sub

    Public Overrides Sub OnExit(
        ByVal eventArgs As PostSharp.Laos.MethodExecutionEventArgs)

        Dim transactionScope As TransactionScope = eventArgs.State

        If eventArgs.Exception Is Nothing Then
            transactionScope.Complete()
        End If

        transactionScope.Dispose()

    End Sub

End Class
</pre>
<p>Here is how the new custom attribute can be used to make a method 
   transactional:</p>
<pre> _
Sub Transfer(ByVal fromAccount As Account, 
     ByVal toAccount As Account, ByVal amount As Decimal)
  fromAccount.Balance -= amount
  toAccount.Balance += amount
End Sub
</pre>
<p>One of the problems, when using custom attributes, is that it should normally 
   be applied to each target explicitly. The .NET languages do not offer the 
   possibility to apply custom attributes to a set of code elements. PostSharp 
   Laos solves this issue by defining a 'multicast' mechanism. For instance, the 
   following code applies the <em>TransactionScope</em> attribute to all methods 
   of all types of a namespace:</p>
